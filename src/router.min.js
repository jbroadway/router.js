var router=(function(b){var a={};a.routes={};a.prefix="";a.a=document.createElement("a");a.click_handler=function(d){if(!d.altKey&&!d.ctrlKey&&!d.metaKey&&!d.shiftKey){d.preventDefault();var c=b(this).attr("href"),f=b(this).attr("title");f=(typeof f=="undefined")?null:a.prefix+f;History.pushState({},f,c)}};a.regexify=function(c){var e={url:c,regex:null,params:[]};var f=c.match(/\:([a-zA-Z0-9_]+)/g);if(f!==null){for(var d in f){f[d]=f[d].substring(1)}e.params=f;c=c.replace(/\:([a-zA-Z0-9_]+)/g,"(.*?)")}e.regex=c.replace("/","\\/");return e};a.set_routes=function(c){for(var d in c){res=a.regexify(d);var e={url:d,regex:new RegExp("^"+res.regex+"/?$","g"),params:res.params,callback:c[d]};a.routes[d]=e}};a.get_path=function(c){a.a.href=c;var d=a.a.pathname+a.a.search+a.a.hash;d=d.match("#")?d.split("#")[1]:d;return d.match(/^\//)?d:"/"+d};a.route=function(c){var f=a.get_path(c);for(var d in a.routes){var e=a.routes[d].regex.exec(f);a.routes[d].regex.lastIndex=0;if(e!==null){if(e.length>1){e.shift();a.routes[d].callback.apply(null,e)}else{a.routes[d].callback()}break}}};a.on_statechange=function(){var c=History.getState();a.route(c.url)};a.go=function(c){if(c===parseInt(c)){History.go(c)}else{History.pushState(null,null,c)}};a.init=function(c){var d=window.History;if(!d.enabled){return false}a.set_routes(c);d.Adapter.bind(window,"statechange",a.on_statechange);b("body").on("click","a[href^='/']",a.click_handler);a.route(window.location.href)};return a})(jQuery);