var router=function(e){var t={};t.routes={};t.prefix="";t.a=document.createElement("a");t.click_handler=function(n){if(!n.altKey&&!n.ctrlKey&&!n.metaKey&&!n.shiftKey){n.preventDefault();var r=e(this).attr("href"),i=e(this).attr("title");i=typeof i=="undefined"?null:t.prefix+i;History.pushState({},i,r)}};t.regexify=function(e){var t={url:e,regex:null,params:[]};var n=e.match(/\:([a-zA-Z0-9_]+)/g);if(n!==null){for(var r in n){n[r]=n[r].substring(1)}t.params=n;e=e.replace(/\:([a-zA-Z0-9_]+)/g,"(.*?)")}t.regex=e.replace("/","\\/");return t};t.set_routes=function(e){for(var n in e){res=t.regexify(n);var r={url:n,regex:new RegExp("^"+res.regex+"/?$","g"),params:res.params,callback:e[n]};t.routes[n]=r}};t.get_path=function(e){t.a.href=e;return t.a.pathname+t.a.search+t.a.hash};t.route=function(e){var n=t.get_path(e);for(var r in t.routes){var i=t.routes[r].regex.exec(n);t.routes[r].regex.lastIndex=0;if(i!==null){if(i.length>1){i.shift();t.routes[r].callback.apply(null,i)}else{t.routes[r].callback()}break}}};t.on_statechange=function(){var e=History.getState();t.route(e.url)};t.go=function(e){if(e===parseInt(e)){History.go(e)}else{History.pushState(null,null,e)}};t.init=function(n){var r=window.History;if(!r.enabled){return false}t.set_routes(n);r.Adapter.bind(window,"statechange",t.on_statechange);e("body").on("click","a[href^='/']",t.click_handler);t.route(window.location.href)};return t}(jQuery)
